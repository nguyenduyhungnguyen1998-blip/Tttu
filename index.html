<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Tam Th√°i T·ª≠ ‚Äî Th√°p H√† N·ªôi (Dashboard N√¢ng C·∫•p)</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
<link rel="stylesheet" href="stylesen.css">
</head>
<body>

  <!-- App Wrapper -->
  <div class="app" id="app">
    <header class="app-header">
      <h1>Tam Th√°i T·ª≠: Th√°p H√† N·ªôi</h1>
      <div class="kv">Ch·∫ø ƒë·ªô: <span id="currentModeDisplay" style="color: var(--accent);">Play</span></div>
    </header>

    <!-- B·ªê C·ª§C DASHBOARD 3 C·ªòT -->
    <div class="dashboard-layout">
      
      <!-- C·ªòT 1: B·∫¢NG ƒêI·ªÄU KHI·ªÇN -->
      <aside class="control-panel">
        <div class="control-group">
          <h4>C√†i ƒë·∫∑t Game</h4>
          <label>S·ªë ƒëƒ©a: <input id="n" type="number" min="1" max="10" value="4"></label>
          <label>Theme:
            <select id="theme" class="theme-select">
              <option value="classic">‚ú® Classic</option>
              <option value="burger">üçî Burger</option>
              <option value="rescue">üê± M√®o</option>
              <option value="neon">üåà Neon</option>
              <option value="dark">üåô Dark Cozy</option>
            </select>
          </label>
        </div>
        <div class="control-group">
          <h4>H√†nh ƒë·ªông</h4>
          <button class="btn" id="reset">Reset Game</button>
          <button class="ghost" id="undo" disabled>Undo</button>
          <button class="ghost" id="hint">G·ª£i √Ω</button>
        </div>
        <div class="control-group">
          <h4>C√¥ng c·ª• & T√πy ch·ªçn</h4>
           <label style="display: none;">T·ªëc ƒë·ªô (Demo):
              <select id="spd" class="speed-select">
                <option value="1200">Ch·∫≠m</option><option value="700" selected>V·ª´a</option><option value="300">Nhanh</option>
              </select>
            </label>
          <button class="ghost" id="changeMode">ƒê·ªïi Ch·∫ø ƒë·ªô</button>
          <button class="ghost" id="appPopupButton">·ª®ng d·ª•ng th·ª±c ti·ªÖn</button>
          <label for="bgm-upload-input" class="ghost upload-btn">T·∫£i nh·∫°c n·ªÅn</label>
          <input type="file" id="bgm-upload-input" accept="audio/*" style="display:none;">
          <label class="sound-toggle">√Çm thanh: <input id="snd" type="checkbox" checked></label>
        </div>
      </aside>

      <!-- C·ªòT 2: S√ÇN KH·∫§U CH√çNH -->
      <main class="center-stage">
        <div class="game-stats">
          <div class="badge">Moves: <span id="mv" aria-live="polite">0</span></div>
          <div class="badge">Best (<span id="best-n">4</span> ƒëƒ©a): <span id="best">‚Äî</span></div>
          <div class="badge">Time: <span id="tm" aria-live="polite">00:00</span></div>
        </div>
        <div class="wrap-stage" id="stage">
          <div class="pole" id="a"><div class="peg"></div><div class="pole-label">1</div></div>
          <div class="pole" id="b"><div class="peg"></div><div class="pole-label">2</div></div>
          <div class="pole" id="c"><div class="peg"></div><div class="pole-label">3</div></div>
        </div>
        <div class="game-footer">
          <div class="progress" title="Ti·∫øn ƒë·ªô"><i id="prog"></i></div>
          <div class="hud kv">G·ª£i √Ω ch·∫ø ƒë·ªô: <span id="hintText" aria-live="polite">‚Äî</span></div>
        </div>
        <div class="footerNote">M·∫πo: K√©o th·∫£ ho·∫∑c d√πng ph√≠m s·ªë (1, 2, 3) ƒë·ªÉ di chuy·ªÉn. Nh·∫•n 'Esc' ƒë·ªÉ h·ªßy.</div>
      </main>

      <!-- C·ªòT 3: TRUNG T√ÇM TH√îNG TIN -->
      <aside class="info-hub">
        <div id="analysisPanel" class="info-card">
          <h3>Ph√¢n t√≠ch Thu·∫≠t to√°n</h3>
          <p>V·ªõi <strong id="analysisN">4</strong> ƒëƒ©a, s·ªë b∆∞·ªõc t·ªëi thi·ªÉu l√† <strong id="analysisMoves">15</strong>.</p>
          <p class="fact"><strong>S·ª± th·∫≠t th√∫ v·ªã:</strong> V·ªõi 64 ƒëƒ©a, n·∫øu m·ªói b∆∞·ªõc m·∫•t 1 gi√¢y, s·∫Ω c·∫ßn t·ªõi <strong id="analysisTime">~585 t·ª∑ nƒÉm</strong> ƒë·ªÉ ho√†n th√†nh!</p>
        </div>
        <div id="learnPanel" class="info-card" style="display:none;">
          <div class="learn-header">
            <h3>Learn Trace (ƒê·ªá quy)</h3>
            <div class="kv">n = <span id="learnN">4</span></div>
          </div>
          <div id="stackArea" class="stack-area"></div>
          <div id="learnExplain" class="learn-explain"></div>
          <div class="learn-controls">
            <button id="learnPrev" class="ghost">Prev</button>
            <button id="learnPlay" class="btn">Play</button>
            <button id="learnPause" class="ghost" style="display:none">Pause</button>
            <button id="learnNext" class="ghost">Next</button>
          </div>
          <label class="kv learn-speed-label">T·ªëc ƒë·ªô:
            <select id="learnSpeed" class="speed-select"><option value="1200">Ch·∫≠m</option><option value="700" selected>V·ª´a</option><option value="300">Nhanh</option></select>
          </label>
        </div>
      </aside>
    </div>
  </div>

  <!-- Popups & Overlays -->
  <div id="greetingPopup" class="fullscreen-overlay">...</div>
  <div id="modeSelect" class="fullscreen-overlay" style="display:none;">...</div>
  <div id="appPopup" class="popup" style="display:none;">...</div>
  <div id="finish" class="finishPop"></div>
  <div id="nearOptimal" class="finishPop"></div>
  <div id="loserPopup" class="popup" style="display:none">...</div>
  
  <audio id="bgm" loop preload="auto"><source src="smooth-gaming-atmosphere-323659.mp3" type="audio/mpeg"></audio>
  <canvas id="confetti"></canvas>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>
<script src="ap.js" defer></script>
</body>
</html>
